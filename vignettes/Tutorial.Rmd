---
title: "Tutorial"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Tutorial}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Install the package
```{r setup}
library(rpackage625)
```

## Data simulation
```{r}
set.seed(2022)
x1 = rnorm(30,3,2) + 0.1*c(1:30)
x2 = rbinom(30,1,0.3)
x3 = rpois(n = 30, lambda = 4)
x3[16:30] = x3[16:30] - rpois(n = 15, lambda = 2)
x = cbind(x1,x2,x3)
y = c(rbinom(5,1,0.1),rbinom(10,1,0.25),rbinom(10,1,0.75),rbinom(5,1,0.9))
```

## Fit the logistic regression model
```{r}
manual_glm <- manual_logistic_regression(x, y)
```

## Examples of getting estimated coefficients, covariance matrix and Residual Deviance
```{r}
manual_glm$coefficients
manual_glm$covariance_matrix
manual_glm$Residual_deviance
```

## Showing all summary details of the logistic regression model
```{r}
print(manual_glm)
```
 
## Comparison: Correctness
```{r}
auto_glm <- glm(y~x1+x2+x3, family = "binomial")
summary(auto_glm)
```

## Comparison: Efficiency
```{r}
# data simulation
set.seed(2022)
x1 = rnorm(3000,2,1) + 0.2*c(1:3000)
x2 = rbinom(3000,1,0.2)
x3 = rpois(n = 3000, lambda = 4)
x3[16:3000] = x3[16:3000] - rpois(n = 15, lambda = 2)
x4 = rnorm(3000,3,2) + 0.1*c(1:3000)
x5 = rbinom(3000,1,0.3)
x = cbind(x1,x2,x3,x4,x5)
y = c(rbinom(500,1,0.1),rbinom(1000,1,0.25),rbinom(1000,1,0.75),rbinom(500,1,0.9))

# test efficiency
system.time(manual_glm <- manual_logistic_regression(x, y))
system.time(auto_glm <- summary(glm(y~x1+x2+x3+x4+x5, family = "binomial")))

set.seed(2022)
x1 = rnorm(300,3,2) + 0.1*c(1:300)
x2 = rbinom(300,1,0.3)
x3 = rpois(n = 300, lambda = 4)
x3[16:300] = x3[16:300] - rpois(n = 15, lambda = 2)
x = cbind(x1,x2,x3)
y = c(rbinom(50,1,0.1),rbinom(100,1,0.25),rbinom(100,1,0.75),rbinom(50,1,0.9))

system.time(manual_glm <- manual_logistic_regression(x, y))
system.time(auto_glm <- summary(glm(y~x1+x2+x3, family = "binomial")))
```

**Comparing to original function, the function 'manual_logistic_regression' is correct and more efficient.**
